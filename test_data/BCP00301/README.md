# BCP-003-01 Certificate Authority

In order to ease testing with TLS, the test suite includes a certificate authority which has been created for this sole
purpose. Typically storing private keys in a code repository would be bad practice, but in this case as the CA will not
be used in production this is not a requirement.

This CA was generated with the assistance of <https://jamielinux.com/docs/openssl-certificate-authority>, and can be
re-generated using the './generateCA' script. Note that re-generating the CA will invalidate any existing certificates.

## Chain of Trust

In order to trust certificates generated by this CA, any device under test will need to load the CA's certificate into
their trust store. The mechanism to do this varies by operating system.

**IMPORTANT:** Do not leave this chain of trust installed in devices once testing has been completed. Otherwise they
will continue to trust any certificates generated by the CA within this repository indefinitely.

The trusted certificate is held in the following file:
*   ca/certs/ca.cert.pem

## Installing Certificates

In order for requests made to the device under test to be trusted by the test suite, the following private keys and
certificates must be loaded into the device. This will provide the device with the hostname 'api.testsuite.nmos.tv',
and the hostname 'nmos-api.local' for mDNS.

**IMPORTANT:** Do not leave this private key and certificate installed on a device once testing is complete.

Note that both an RSA and ECDSA certificate are provided in order to meet the requirements of BCP-003-01. Please consult
your TLS library or application for the configuration required in order to load two certificates at once.

Device under test uses:
*   intermediate/private/rsa.api.testsuite.nmos.tv.key.pem
*   intermediate/private/ecdsa.api.testsuite.nmos.tv.key.pem
*   intermediate/certs/rsa.api.testsuite.nmos.tv.cert.chain.pem
*   intermediate/certs/ecdsa.api.testsuite.nmos.tv.cert.chain.pem

Alternatively, if your web server requires the CA's intermediate to be separate, please use:
*   intermediate/certs/intermediate.cert.pem
*   intermediate/certs/rsa.api.testsuite.nmos.tv.cert.pem
*   intermediate/certs/ecdsa.api.testsuite.nmos.tv.cert.pem

## Additional Certificates

Additional certificates can be generated using this CA if required, using the './generateCerts' script followed by a
domain name and an optional additional domain name ending in '.local' for mDNS usage.

Example: ./generateCerts myapi.testsuite.nmos.tv myapi.local

## Other Notes

CA and intermediate are valid for 50 years
CA/Intermediate CN: ca.testsuite.nmos.tv

Any web servers activated by the test suite itself should use the following private keys and certificates. These use the
hostname 'mocks.testsuite.nmos.tv', and the hostname 'nmos-mocks.local' for mDNS.
*   intermediate/private/rsa.mocks.testsuite.nmos.tv.key.pem
*   intermediate/private/ecdsa.mocks.testsuite.nmos.tv.key.pem
*   intermediate/certs/rsa.mocks.testsuite.nmos.tv.cert.chain.pem
*   intermediate/certs/ecdsa.mocks.testsuite.nmos.tv.cert.chain.pem
